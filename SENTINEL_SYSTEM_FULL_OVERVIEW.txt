# ğŸ›°ï¸ SENTINEL SYSTEM: FULL ARCHITECTURE & DIRECTORY OVERVIEW

---

## 1. ğŸ“¦ Directory Structure (As of August 2025)

```
sentinel/
â”‚
â”œâ”€â”€ AirCodum/                  # (Custom/3rd-party code or data, not core)
â”œâ”€â”€ db/                        # Local database files and vector DBs
â”‚   â”œâ”€â”€ sentinel_missions.db
â”‚   â””â”€â”€ chroma_memory/
â”‚       â”œâ”€â”€ chroma.sqlite3
â”‚       â””â”€â”€ ...                # ChromaDB vector storage
â”œâ”€â”€ desktop-app/               # ğŸš€ Main application (Flask backend + SPA frontend)
â”‚   â”œâ”€â”€ config/                # Python config modules
â”‚   â”œâ”€â”€ db/                    # (Legacy or app-specific DB files)
â”‚   â”œâ”€â”€ logs/                  # Application logs
â”‚   â”œâ”€â”€ scripts/               # Utility and management scripts
â”‚   â”œâ”€â”€ src/                   # Python backend (Flask app, API, models, core logic)
â”‚   â”‚   â”œâ”€â”€ agents/            # Agent logic and orchestration
â”‚   â”‚   â”œâ”€â”€ api/               # REST API endpoints (missions, events, etc.)
â”‚   â”‚   â”œâ”€â”€ core/              # Core business logic, services, and managers
â”‚   â”‚   â”œâ”€â”€ models/            # SQLAlchemy ORM models (Mission, Event, etc.)
â”‚   â”‚   â”œâ”€â”€ tools/             # Utility modules and helpers
â”‚   â”‚   â”œâ”€â”€ utils/             # General utilities (logging, config, etc.)
â”‚   â”‚   â”œâ”€â”€ main.py            # Flask app entry point
â”‚   â”‚   â””â”€â”€ ...                # Other backend logic
â”‚   â”œâ”€â”€ static/                # Frontend static assets
â”‚   â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â”‚   â”œâ”€â”€ sentinel-dash.css   # Main dashboard and modal styling
â”‚   â”‚   â”‚   â””â”€â”€ ...            # Other CSS files
â”‚   â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”‚   â””â”€â”€ unified-realtime.js # Main JS controller (Alpine.js, real-time, modal logic)
â”‚   â”‚   â”œâ”€â”€ fonts/
â”‚   â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â””â”€â”€ ...                # Other static assets
â”‚   â”œâ”€â”€ templates/             # Jinja2 HTML templates (SPA shell, modals, dashboard)
â”‚   â”‚   â”œâ”€â”€ index.html         # Main SPA entry
â”‚   â”‚   â”œâ”€â”€ missions.html      # Missions dashboard & modal (core UI)
â”‚   â”‚   â”œâ”€â”€ analytics.html     # Analytics/observability UI
â”‚   â”‚   â””â”€â”€ ...                # Other UI pages
â”‚   â”œâ”€â”€ tests/                 # Python test suite (unit/integration)
â”‚   â”œâ”€â”€ requirements.txt       # Python dependencies
â”‚   â”œâ”€â”€ requirements_sentry.txt# Sentry/observability dependencies
â”‚   â”œâ”€â”€ pyproject.toml         # Python project config
â”‚   â”œâ”€â”€ setup.cfg              # Linting/formatting config
â”‚   â”œâ”€â”€ start_servers.ps1      # Windows server startup script
â”‚   â”œâ”€â”€ start_cognitive_forge.py # Main orchestrator script
â”‚   â””â”€â”€ ...                    # Other app-level scripts and docs
â”œâ”€â”€ logs/                      # Top-level logs (may be symlinked)
â”œâ”€â”€ wandb/                     # Weights & Biases experiment logs
â”œâ”€â”€ workspace/                 # User workspace, temp files, or agent outputs
â””â”€â”€ ...                        # Other top-level folders (docs, configs, etc.)
```

---

## 2. ğŸ§  System Logic & Data Flow

### 2.1. **Frontend (desktop-app/static & templates)**

```
[ index.html ]
     â”‚
     â–¼
[ unified-realtime.js (Alpine.js SPA Controller) ]
     â”‚
     â”œâ”€â”€ [ missions.html ] (Mission queue, modal, event feed)
     â”œâ”€â”€ [ analytics.html ] (Observability dashboard)
     â””â”€â”€ [ sentinel-dash.css ] (Styling)
```

- **SPA Shell**: Loads all JS/CSS, bootstraps Alpine.js app.
- **Missions UI**: Displays mission queue, mission modals, and real-time event feeds.
- **JS Controller**: Manages all mission modal logic, event streaming, state, and Alpine.js reactivity.
- **Styling**: Provides all dashboard, modal, and event feed styles.

### 2.2. **Backend (desktop-app/src)**

```
[ main.py (Flask App Entrypoint) ]
     â”‚
     â”œâ”€â”€ [ api/ ] (REST endpoints)
     â”œâ”€â”€ [ models/ ] (SQLAlchemy ORM)
     â”œâ”€â”€ [ core/ ] (Business logic, managers)
     â”œâ”€â”€ [ agents/ ] (LLM/Hybrid agent logic)
     â”œâ”€â”€ [ tools/, utils/ ] (Helpers)
     â””â”€â”€ ...
```

- **Entry Point**: Starts Flask app, loads config, registers blueprints.
- **API Layer**: Exposes REST endpoints for missions, events, analytics, etc.
- **Models**: Defines SQLAlchemy ORM models for Mission, Event, User, etc.
- **Core Logic**: Contains business logic, mission orchestration, and service managers.
- **Agents**: Implements agent logic, LLM orchestration, and hybrid decision engine.
- **Tools/Utils**: Helper modules for logging, config, and utility functions.

### 2.3. **Database & Vector DB**

```
[ PostgreSQL (DATABASE_URL) ]
     â”‚
     â””â”€â”€ [ SQLAlchemy ORM Models ]

[ ChromaDB / Pinecone (VECTOR_DB_URL) ]
     â”‚
     â””â”€â”€ [ Vector memory for agents, analytics ]
```

- **Relational DB**: PostgreSQL stores missions, events, users, etc.
- **Vector DB**: ChromaDB (or Pinecone) for memory/embedding storage, used by agents and analytics.

### 2.4. **Observability & Analytics**

```
[ Sentry ] <â”€â”€ Error tracking
[ Weave ] <â”€â”€ Real-time observability
[ WandB ] <â”€â”€ Experiment tracking
```

- **Sentry**: Error tracking and reporting (SENTRY_DSN, SENTRY_AUTH_TOKEN)
- **Weave & WandB**: Real-time observability, experiment tracking, and analytics
- **Advanced Analytics**: Enabled via `.env` flags, surfaced in analytics.html and modals.

### 2.5. **Configuration & Security**

- **.env**: Central config for all services (AI keys, DB, observability, cache, security)
- **Security**: Shell command execution is sandboxed/limited by config.

---

## 3. ğŸ–¼ï¸ Visual System Map

```
+-------------------+         +-------------------+         +-------------------+
|   Frontend (SPA)  | <â”€â”€â”€â”€â”€â–º |   Flask Backend   | <â”€â”€â”€â”€â”€â–º |   PostgreSQL DB   |
|  (Alpine.js/JS)   |   API   |   (Python)        |   ORM   |   (Relational)    |
+-------------------+         +-------------------+         +-------------------+
         â”‚                            â”‚                             â”‚
         â”‚                            â”‚                             â”‚
         â–¼                            â–¼                             â–¼
+-------------------+         +-------------------+         +-------------------+
|  ChromaDB/Pinecone| <â”€â”€â”€â”€â”€â–º |  Agents/LLMs      | <â”€â”€â”€â”€â”€â–º |  Observability    |
|  (Vector Memory)  |   API   |  (Hybrid Engine)  |   Logs  |  (Sentry/Weave)   |
+-------------------+         +-------------------+         +-------------------+
```

---

## 4. ğŸ” Component Breakdown

### 4.1. **Frontend Components**
- **index.html**: SPA entry, loads all scripts/styles
- **missions.html**: Mission queue, modal, event feed, analytics tabs
- **analytics.html**: System analytics, observability dashboard
- **unified-realtime.js**: Alpine.js SPA controller, manages:
  - Mission modal open/close
  - Real-time event feed (WebSocket/REST)
  - Event limiting (10 recent + View All)
  - State management, auto-refresh, error handling
- **sentinel-dash.css**: All dashboard, modal, and event feed styles

### 4.2. **Backend Components**
- **main.py**: Flask app entry, config loader, blueprint registration
- **api/**: REST endpoints for missions, events, analytics
- **models/**: SQLAlchemy ORM models (Mission, Event, User, etc.)
- **core/**: Business logic, mission orchestration, service managers
- **agents/**: LLM/hybrid agent logic, decision engine
- **tools/**, **utils/**: Logging, config, helpers

### 4.3. **Database & Observability**
- **PostgreSQL**: Main relational DB for missions, events, users
- **ChromaDB/Pinecone**: Vector DB for agent memory, analytics
- **Sentry**: Error tracking
- **Weave/WandB**: Real-time observability, experiment tracking

### 4.4. **Configuration & Security**
- **.env**: All environment variables (AI keys, DB, observability, cache, security)
- **Security**: Shell command execution is sandboxed/limited by config

---

## 5. ğŸ› ï¸ Key Workflows

### 5.1. **Mission Lifecycle**
1. User creates mission (UI form)
2. Mission sent to Flask API (`/api/missions`)
3. Mission stored in PostgreSQL (SQLAlchemy)
4. Agent picks up mission, processes via LLM/Hybrid engine
5. Events generated, streamed to frontend (WebSocket/REST)
6. User views mission modal, sees real-time updates
7. Mission completion triggers analytics, observability logging

### 5.2. **Event Feed Logic**
- Events are sorted by timestamp (newest first)
- Only 10 most recent events shown by default
- "View All" button expands to show all events
- Real-time updates via polling or WebSocket

### 5.3. **Observability & Analytics**
- Errors sent to Sentry
- Metrics and traces sent to Weave/WandB
- Analytics tab in modal shows live system health

---

## 6. ğŸ“ Summary Table

| Layer      | Technology         | Key Files/Dirs                | Purpose/Notes                       |
|------------|--------------------|-------------------------------|-------------------------------------|
| Frontend   | Alpine.js, Bootstrap| static/js, static/css, templates | SPA, modals, real-time UI           |
| Backend    | Flask, SQLAlchemy  | src/, api/, models/, core/    | API, business logic, orchestration  |
| Database   | PostgreSQL         | db/, models/                  | Relational data store               |
| Vector DB  | ChromaDB/Pinecone  | db/chroma_memory/             | Agent memory, analytics             |
| Observability | Sentry, Weave, WandB | .env, analytics.html      | Error tracking, analytics           |
| Config     | .env, config/      | .env, config/                 | Centralized configuration           |
| Security   | Python, .env       | .env, src/tools/              | Shell command sandboxing            |

---

## 7. ğŸ“š Additional Notes
- All configuration is managed via `.env` for easy environment switching.
- The system is designed for extensibility: new agents, analytics, or UI modules can be added with minimal friction.
- Observability is a first-class concern: all errors, metrics, and traces are logged and visualized.
- The hybrid agent engine can switch between LLMs and memory DBs based on config and runtime thresholds.
- Security is enforced at the API and shell command level.

---

# END OF OVERVIEW

This document provides a full, visual, and detailed breakdown of the Sentinel system, its directory structure, logic, and all major components. For further architectural diagrams or deep dives into any module, please request a focused breakdown.
